import{S as F,i as X,s as Y,e as O,k,c as M,a as N,m as P,d,b as w,g as b,H as ee,U as te,K as ne,L as re,M as le,q as _,o as m,n as U,p as B,a3 as Z,J as se,w as q,x as L,y as A,E as y,B as I,l as E,G as ae,a5 as $,a6 as ie}from"../chunks/index-4d2c28a6.js";import{d as oe,b as z,i as ce,c as fe,u as ue,m as he,a as ge,o as _e,s as H,g as V}from"../chunks/search-index-e0a82dcb.js";import{I as pe,H as me}from"../chunks/Header-311c21ed.js";import{R as x}from"../chunks/ResultTile-0037ca08.js";import{S as de}from"../chunks/Spinner-67ef88e7.js";import"../chunks/index-af12e26e.js";import"../chunks/singletons-d1fb5791.js";import"../chunks/RegionMap-0a5d1d9b.js";import"../chunks/index-41dc71ea.js";Array.prototype.at||Object.defineProperty(Array.prototype,"at",{value:function(n){const e=Object(this);return n<0?e[e.length+n]:e[n]}});async function ye(n,e){const r=we(n);return await S(r,e)}async function S(n,e){if(n===void 0)return()=>0;if(n.type==="and"){const r=await S(n.left,e),l=await S(n.right,e);return t=>r(t)+l(t)}else if(n.type==="or"){const r=await S(n.left,e),l=await S(n.right,e);return t=>Math.min(r(t),l(t))}else if(n.type==="tag"){const r=n.string;return n.positive?({tags:l})=>l.includes(r)?0:1/0:({tags:l})=>l.includes(r)?1/0:0}else if(n.type==="word"){const r=n.vector||await e(n.string);if(r)return({words:l})=>{const a=l.filter(s=>typeof s!="string").map(s=>oe(s,r));return Math.min(...a)};{const l=n.string;return({words:t})=>t.some(a=>typeof a=="string"&&a.toLowerCase()===l)?0:1/0}}else throw new Error("unknown ast node type")}function be(n){const e=[""];for(const r of n)'"\u201C\u201D()'.includes(r)?e.unshift("",r):` 	\r
`.includes(r)?e.unshift(""):e[0]+=r;return e.reverse().filter(r=>r.length>0)}function we(n){return v(be(n))}const ve=[function(e){const r=[...e],l=[];let t=[],a=0;for(;r.length>0;){const s=r.shift();s==="("?(a+=1,a>1?t.push(s):t=[]):s===")"?(a>1?t.push(s):a===1&&l.push(v(t)),a-=1):a>0?t.push(s):l.push(s)}return l},function(e){const r=[];for(const l of e)if(r.length>1&&r.at(-1)==="OR"){const t=r.pop().toLowerCase(),a=v([r.pop()]),s=v([l]);r.push({type:t,left:a,right:s})}else r.push(l);return r},function(e){const r=[];for(const l of e)if(r.length>1&&r.at(-1)==="AND"){const t=r.pop().toLowerCase(),a=v([r.pop()]),s=v([l]);r.push({type:t,left:a,right:s})}else r.push(l);return r},function(e){return e.map(r=>{if(typeof r=="string"){if(r.startsWith("#"))return{type:"tag",string:r.slice(1),positive:!0};if(r.startsWith("-#"))return{type:"tag",string:r.slice(2),positive:!1}}return r})},function(e){return e.map(r=>typeof r=="string"?{type:"word",string:r}:r)},function n(e){if(e.length<=1)return e;if(e.length===2)return[{type:"and",left:e[0],right:e[1]}];if(e.length>2)return[{type:"and",left:e[0],right:n(e.slice(1))}]}];function v(n){if(!Array.isArray(n))return n;if(n.length!==0){for(const e of ve)n=e(n);if(n.length===1){if(typeof n[0]=="string")throw new Error("Token Parser failed somehow, string result");return n[0]}}}function ke(n,e){const r=Object.create(n);return r.index=n.index.flatMap(l=>{const t=e(l);if(typeof t=="number"&&t<1/0){const a=Object.create(l);return a.rank=t+a.diversity*.05,[a]}else return[]}).sort((l,t)=>l.rank-t.rank),r}async function Pe(n){const e=typeof n=="string"?new TextEncoder().encode(n):n,r=await window.crypto.subtle.digest("SHA-256",e);return new Uint8Array(r)}async function qe(n,e){const l=await(await e(`${n}/settings.json`,{mode:"cors",cache:"force-cache"})).json();return{path:n,settings:l,fetch:e}}async function Le(n,e){const r=await Pe(e),l=parseInt(z(r,n.settings.prefixBits),2),t=parseInt(z(r,n.settings.shardBits),2),a=await n.fetch(`${n.path}/shards/${l}/${t}.cbor`,{mode:"cors",cache:"force-cache"}),s=ce(await a.arrayBuffer());for(const[o,i,f]of fe(s,3))if(o===e){const h=ue(f,n.settings.vectorBits,n.settings.vectorSize);return he([h],ge(i,h.length))[0]}}function W(n,e,r){const l=n.slice();return l[7]=e[r],l[9]=r,l}const Ae=n=>({}),D=n=>({page:!0});function Ie(n){let e,r;return e=new pe({props:{name:`${n[9]+1}`}}),{c(){q(e.$$.fragment)},l(l){L(e.$$.fragment,l)},m(l,t){A(e,l,t),r=!0},p:y,i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){m(e.$$.fragment,l),r=!1},d(l){I(e,l)}}}function Q(n){let e,r,l,t,a,s,o,i;const f=n[5].default,h=se(f,n,n[4],D),g=h||Ie(n);function R(){return n[6](n[9])}return{c(){e=O("a"),g&&g.c(),r=k(),this.h()},l(u){e=M(u,"A",{href:!0,"aria-label":!0,"aria-current":!0,class:!0});var c=N(e);g&&g.l(c),r=P(c),c.forEach(d),this.h()},h(){w(e,"href",l=n[2]?n[2](n[9]):"#"),w(e,"aria-label",t=n[3](n[9])),w(e,"aria-current",a=n[9]===n[0]?"page":!1),w(e,"class","svelte-ij6z6a")},m(u,c){b(u,e,c),g&&g.m(e,null),ee(e,r),s=!0,o||(i=te(e,"click",R),o=!0)},p(u,c){n=u,h&&h.p&&(!s||c&16)&&ne(h,f,n,n[4],s?le(f,n[4],c,Ae):re(n[4]),D),(!s||c&4&&l!==(l=n[2]?n[2](n[9]):"#"))&&w(e,"href",l),(!s||c&8&&t!==(t=n[3](n[9])))&&w(e,"aria-label",t),(!s||c&1&&a!==(a=n[9]===n[0]?"page":!1))&&w(e,"aria-current",a)},i(u){s||(_(g,u),s=!0)},o(u){m(g,u),s=!1},d(u){u&&d(e),g&&g.d(u),o=!1,i()}}}function Se(n){let e,r,l={length:n[1]},t=[];for(let s=0;s<l.length;s+=1)t[s]=Q(W(n,l,s));const a=s=>m(t[s],1,1,()=>{t[s]=null});return{c(){e=O("nav");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=M(s,"NAV",{class:!0});var o=N(e);for(let i=0;i<t.length;i+=1)t[i].l(o);o.forEach(d),this.h()},h(){w(e,"class","svelte-ij6z6a")},m(s,o){b(s,e,o);for(let i=0;i<t.length;i+=1)t[i].m(e,null);r=!0},p(s,[o]){if(o&31){l={length:s[1]};let i;for(i=0;i<l.length;i+=1){const f=W(s,l,i);t[i]?(t[i].p(f,o),_(t[i],1)):(t[i]=Q(f),t[i].c(),_(t[i],1),t[i].m(e,null))}for(U(),i=l.length;i<t.length;i+=1)a(i);B()}},i(s){if(!r){for(let o=0;o<l.length;o+=1)_(t[o]);r=!0}},o(s){t=t.filter(Boolean);for(let o=0;o<t.length;o+=1)m(t[o]);r=!1},d(s){s&&d(e),Z(t,s)}}}function Re(n,e,r){let{$$slots:l={},$$scope:t}=e,{length:a=1}=e,{selected:s=0}=e,{toURL:o=h=>`?page=${h}`}=e,{toAriaLabel:i=h=>`Go to page ${h+1}`}=e;const f=h=>r(0,s=h);return n.$$set=h=>{"length"in h&&r(1,a=h.length),"selected"in h&&r(0,s=h.selected),"toURL"in h&&r(2,o=h.toURL),"toAriaLabel"in h&&r(3,i=h.toAriaLabel),"$$scope"in h&&r(4,t=h.$$scope)},[s,a,o,i,t,l,f]}class je extends F{constructor(e){super(),X(this,e,Re,Se,Y,{length:1,selected:0,toURL:2,toAriaLabel:3})}}function G(n,e,r){const l=n.slice();return l[6]=e[r],l}function Ue(n){let e,r;return e=new de({props:{class:"spinner",active:!0}}),{c(){q(e.$$.fragment)},l(l){L(e.$$.fragment,l)},m(l,t){A(e,l,t),r=!0},p:y,i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){m(e.$$.fragment,l),r=!1},d(l){I(e,l)}}}function Be(n){let e,r,l=n[4],t=[];for(let s=0;s<l.length;s+=1)t[s]=J(G(n,l,s));const a=s=>m(t[s],1,1,()=>{t[s]=null});return{c(){e=O("div");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=M(s,"DIV",{class:!0});var o=N(e);for(let i=0;i<t.length;i+=1)t[i].l(o);o.forEach(d),this.h()},h(){w(e,"class","results svelte-6vojt7")},m(s,o){b(s,e,o);for(let i=0;i<t.length;i+=1)t[i].m(e,null);r=!0},p(s,o){if(o&17){l=s[4];let i;for(i=0;i<l.length;i+=1){const f=G(s,l,i);t[i]?(t[i].p(f,o),_(t[i],1)):(t[i]=J(f),t[i].c(),_(t[i],1),t[i].m(e,null))}for(U(),i=l.length;i<t.length;i+=1)a(i);B()}},i(s){if(!r){for(let o=0;o<l.length;o+=1)_(t[o]);r=!0}},o(s){t=t.filter(Boolean);for(let o=0;o<t.length;o+=1)m(t[o]);r=!1},d(s){s&&d(e),Z(t,s)}}}function Ee(n){return{c:y,l:y,m:y,p:y,i:y,o:y,d:y}}function Ce(n){let e,r,l;return e=new x({props:{data:n[9],permalink:"/sign/"+n[9].provider+"/"+n[9].id}}),{c(){q(e.$$.fragment),r=k()},l(t){L(e.$$.fragment,t),r=P(t)},m(t,a){A(e,t,a),b(t,r,a),l=!0},p(t,a){const s={};a&17&&(s.data=t[9]),a&17&&(s.permalink="/sign/"+t[9].provider+"/"+t[9].id),e.$set(s)},i(t){l||(_(e.$$.fragment,t),l=!0)},o(t){m(e.$$.fragment,t),l=!1},d(t){I(e,t),t&&d(r)}}}function Oe(n){let e,r,l;return e=new x({}),{c(){q(e.$$.fragment),r=k()},l(t){L(e.$$.fragment,t),r=P(t)},m(t,a){A(e,t,a),b(t,r,a),l=!0},p:y,i(t){l||(_(e.$$.fragment,t),l=!0)},o(t){m(e.$$.fragment,t),l=!1},d(t){I(e,t),t&&d(r)}}}function J(n){let e,r,l,t={ctx:n,current:null,token:null,hasCatch:!1,pending:Oe,then:Ce,catch:Ee,value:9,blocks:[,,,]};return $(r=V(n[0],n[6]),t),{c(){e=E(),t.block.c()},l(a){e=E(),t.block.l(a)},m(a,s){b(a,e,s),t.block.m(a,t.anchor=s),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(a,s){n=a,t.ctx=n,s&17&&r!==(r=V(n[0],n[6]))&&$(r,t)||ie(t,n,s)},i(a){l||(_(t.block),l=!0)},o(a){for(let s=0;s<3;s+=1){const o=t.blocks[s];m(o)}l=!1},d(a){a&&d(e),t.block.d(a),t.token=null,t=null}}}function K(n){let e,r;return e=new je({props:{selected:n[2],length:n[3],toURL:n[5]}}),{c(){q(e.$$.fragment)},l(l){L(e.$$.fragment,l)},m(l,t){A(e,l,t),r=!0},p(l,t){const a={};t&4&&(a.selected=l[2]),t&8&&(a.length=l[3]),t&2&&(a.toURL=l[5]),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){m(e.$$.fragment,l),r=!1},d(l){I(e,l)}}}function Me(n){let e,r,l,t,a,s,o,i,f;document.title=e="\u201C"+n[1]+"\u201D - Find Sign",l=new me({props:{query:n[1],showNavigation:!1}});const h=[Be,Ue],g=[];function R(c,p){return c[4]?0:1}a=R(n),s=g[a]=h[a](n);let u=n[3]>0&&K(n);return{c(){r=k(),q(l.$$.fragment),t=k(),s.c(),o=k(),u&&u.c(),i=E()},l(c){ae('[data-svelte="svelte-2cfkki"]',document.head).forEach(d),r=P(c),L(l.$$.fragment,c),t=P(c),s.l(c),o=P(c),u&&u.l(c),i=E()},m(c,p){b(c,r,p),A(l,c,p),b(c,t,p),g[a].m(c,p),b(c,o,p),u&&u.m(c,p),b(c,i,p),f=!0},p(c,[p]){(!f||p&2)&&e!==(e="\u201C"+c[1]+"\u201D - Find Sign")&&(document.title=e);const T={};p&2&&(T.query=c[1]),l.$set(T);let C=a;a=R(c),a===C?g[a].p(c,p):(U(),m(g[C],1,1,()=>{g[C]=null}),B(),s=g[a],s?s.p(c,p):(s=g[a]=h[a](c),s.c()),_(s,1),s.m(o.parentNode,o)),c[3]>0?u?(u.p(c,p),p&8&&_(u,1)):(u=K(c),u.c(),_(u,1),u.m(i.parentNode,i)):u&&(U(),m(u,1,1,()=>{u=null}),B())},i(c){f||(_(l.$$.fragment,c),_(s),_(u),f=!0)},o(c){m(l.$$.fragment,c),m(s),m(u),f=!1},d(c){c&&d(r),I(l,c),c&&d(t),g[a].d(c),c&&d(o),u&&u.d(c),c&&d(i)}}}const j=10,Ne=9;async function Ke({url:n,fetch:e}){const r=n.searchParams.get("query")||"",l=parseInt(n.searchParams.get("page")||"0");n.searchParams.get("ssrplz");let t=[],a=0,s;if(r.trim()==="")return{status:301,redirect:"/"};{s=await _e(H.searchIndex);const o=await qe(H.vectorIndex,(...h)=>e(...h)),i=await ye(r,h=>Le(o,h));console.log("queryFn",i);const f=ke(s,i);t=f.index.slice(l*j,l*j+j),a=Math.min(Ne,Math.ceil(f.index.length/j))}return{props:{query:r,page:l,results:t,totalPages:a,library:s}}}function Te(n,e,r){let{library:l}=e,{query:t=""}=e,{page:a=0}=e,{totalPages:s=0}=e,{results:o=[]}=e;const i=f=>`?${new URLSearchParams(Object.entries({query:t,page:f}))}`;return n.$$set=f=>{"library"in f&&r(0,l=f.library),"query"in f&&r(1,t=f.query),"page"in f&&r(2,a=f.page),"totalPages"in f&&r(3,s=f.totalPages),"results"in f&&r(4,o=f.results)},[l,t,a,s,o,i]}class Fe extends F{constructor(e){super(),X(this,e,Te,Me,Y,{library:0,query:1,page:2,totalPages:3,results:4})}}export{Fe as default,Ke as load};
